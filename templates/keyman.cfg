
KMXRULES=<<EOT
$($(k)_KMX) : $($(k)_KMN)
	wine $(KMNCOMPILER) $< $@

EOT

KMNSVGRULES=<<EOT
$($(k)_SVG) : $($(k)_KMN)
	$(TEMPLATE_DIR)/bin/kmn2xml $< > temp.xml
	$(TEMPLATE_DIR)/bin/kmnxml2svg -t $(TEMPLATE_DIR)/bin/keyboard.svg temp.xml $@
EOT


TEMPLATE_DIR=$(!or $(exist ($TEMPLATE_DIR)), $(exist templates))
AUTOSUB|=perl $(TEMPLATE_DIR)/autosub -c $(CONFIG_FILE) -c $(TEMPLATE_DIR)/keyman.cfg -d . -x \~  $(TEMPLATE_DIR)/keyboards
